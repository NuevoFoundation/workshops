<!doctype html><html><head><title>Nuevo Foundation Workshops</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#000000"><meta name=revised content="2023-01-27T02:25:51 UTC"><meta name=application-name content=" "><meta name=msapplication-TileColor content="#FFFFFF"><meta name=msapplication-TileImage content="mstile-144x144.png"><meta name=msapplication-square70x70logo content="mstile-70x70.png"><meta name=msapplication-square150x150logo content="mstile-150x150.png"><meta name=msapplication-wide310x150logo content="mstile-310x150.png"><meta name=msapplication-square310x310logo content="mstile-310x310.png"><title>Plotting the Model and its Predictions :: Nuevo Foundation Workshops</title><link rel="shortcut icon" href=/workshops/images/favicon.png type=image/x-icon><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css rel=stylesheet><link href=/workshops/css/nucleus.css rel=stylesheet><link href=/workshops/theme-flex/style.css rel=stylesheet><link rel="shortcut icon" href=https://www.nuevofoundation.org/favicons/favicon.ico><link rel=apple-touch-icon-precomposed sizes=57x57 href=https://www.nuevofoundation.org/favicons//apple-touch-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=./favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=https://www.nuevofoundation.org/favicons/pple-touch-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-152x152.png><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-128.png sizes=128x128><link href="https://fonts.googleapis.com/css?family=Space+Mono:700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.3.5/dist/css/bootstrap.min.css><link type=text/css rel=stylesheet href=/workshops/css/nuevoweb.css><link rel=stylesheet href=/workshops/css/chunk.css><link rel=stylesheet href=/workshops/css/data-style.css><script src=/workshops/js/jquery-2.x.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script type=text/javascript>var baseurl="https:\/\/nuevofoundation.github.io\/workshops\/";</script><script lang=javascript>function toggleVisibility(){const menu=document.getElementById("mobile-nav-menu");if(menu.style.display=='none'){menu.classList.replace("transition-out","transition-in")
menu.style.display='block';}
else if(menu.style.display=='block'){menu.classList.replace("transition-in","transition-out")
menu.style.display='none';}}</script><meta name=description content></head><body data-url=/workshops/python-tensorflow/plotting_model/><header><div id=mobile-nav-menu class=transition-out style=display:none><div class=close-btn onclick=toggleVisibility();><i aria-hidden=true focusable=false style=cursor:pointer class="fa fa-times fa-w-11 fa-sm"></i></div><div><div class="sc-dNLxif ecnYUM"><a href=/support-us><button class="sc-jbKcbu sedGx" style="background-color:#fff;color:#000;border:4px solid #000;border-radius:4px">
Donate</button></a></div></div><hr><div><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/what-we-do><ul class="sc-uJMKN fRSLiB"><li>What We Do</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/get-involved><ul class="sc-uJMKN fRSLiB"><li>Get Involved</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/support-us><ul class="sc-uJMKN fRSLiB"><li>Support us</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/blog><ul class="sc-uJMKN fRSLiB"><li>Event blog</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/about-us><ul class="sc-uJMKN fRSLiB"><li>Our team</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/contact><ul class="sc-uJMKN fRSLiB"><li>Contact us</li></ul></a></div></div><div><div class="sc-gGBfsJ iKkPGj"><div class=container-fluid><div id=toprow class=row><div class=col-xs-12><div class="sc-EHOje fJMnSm"><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation><i aria-label="Nuevo Foundation Instagram" class="fab fa-instagram"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation><i aria-label="Nuevo Foundation Twitter" class="fab fa-twitter"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation><i aria-label="Nuevo Foundation Facebook" class="fab fa-facebook-f"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-linkedin"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1n"><i aria-label="Nuevo Foundation YouTube" class="fab fa-youtube"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation><i aria-label="Nuevo Foundation Github" class="fab fa-github"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" rel="noopener noreferrer" href=https://nuevofoundation.org/support-us>Donate</a></div></div></div></div><div id=secondrow class=row><div class="col-sm-12 hidden-xs"><div class="sc-htoDjs kjtfZK"><a class="sc-fjdhpX izNzAG active" aria-current=page href=https://nuevofoundation.org><img alt="Nuevo Foundation Logo" src=/workshops/images/Logo_long.0f097b90.svg height=60px></a><ul class="sc-iwsKbI bUOvG"><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/what-we-do><li class="sc-gZMcBi Bomeo">What We Do</li></a><a class=izNzAG href=/><li class="sc-gZMcBi Bomeo-selected jgBGVn">Workshops<span></span></li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/get-involved><li class="sc-gZMcBi Bomeo">Get Involved</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/support-us><li class="sc-gZMcBi Bomeo">Support us</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/blog><li class="sc-gZMcBi Bomeo">Event blog</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/about-us><li class="sc-gZMcBi Bomeo">Our team</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/contact><li class="sc-gZMcBi Bomeo">Contact us</li></a></ul></div></div><div class="hidden-lg hidden-md hidden-sm col-xs-12"><div class=row><div class=col-xs-10><a class="sc-fjdhpX izNzAG active" aria-current=page href=/><img alt="Nuevo Foundation Logo" class="sc-dnqmqq emolVn" src=/workshops/images/Logo_long.0f097b90.svg height=60%></a></div><div class=col-xs-2 onclick=toggleVisibility(); style=padding-top:4%;padding-left:4%;cursor:pointer><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 fa-lg" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></div></div></div></div></div></div></header><article><aside><ul class=menu><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/ class="dd-item parent haschildren"><div><a href=/workshops/python-tensorflow/>Python: Machine Learning Basics using TensorFlow</a>
<i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/welcome/ class=dd-item><div><a href=/workshops/python-tensorflow/welcome/>Welcome to your new Summer job!
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-1/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-1/>Activity 1 - Importing the TensorFlow library and datasets
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-2/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-2/>Activity 2 - Displaying RGB Color Values for Images
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/progress_update_1/ class=dd-item><div><a href=/workshops/python-tensorflow/progress_update_1/>Progress Update 1
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-3/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-3/>Activity 3 - Displaying Clothing Samples
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/building_neural_network/ class=dd-item><div><a href=/workshops/python-tensorflow/building_neural_network/>Building the Neural Network
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-4/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-4/>Activity 4 - Training the Model
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-5/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-5/>Activity 5 - Testing the Model
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-6/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-6/>Activity 6 - Testing the Model (Again!)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/progress_update_2/ class=dd-item><div><a href=/workshops/python-tensorflow/progress_update_2/>Progress Update 2
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/plotting_model/ class="dd-item active"><div><a href=/workshops/python-tensorflow/plotting_model/>Plotting the Model and its Predictions
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-7/ class=dd-item><div><a href=/workshops/python-tensorflow/activity-7/>Activity 7 - Plotting an Image's predicted Category
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/progress_update_3/ class=dd-item><div><a href=/workshops/python-tensorflow/progress_update_3/>Progress Update 3
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/python-tensorflow/wrapup/ class=dd-item><div><a href=/workshops/python-tensorflow/wrapup/>Workshop Conclusion
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li></ul><section></section></aside><section class=page><div align=right><select id=select-language onchange="location=this.value;">
<option id=en value=https://nuevofoundation.github.io/workshops/python-tensorflow/plotting_model/ selected>English</option></select></div><div class=nav-select>Navigation:&nbsp;
<select onchange="location.href=this.value;">
<option value=/workshops/python-tensorflow/>Python: Machine Learning Basics using TensorFlow</option>
<option value=/workshops/python-tensorflow/welcome/>- Welcome to your new Summer job!</option>
<option value=/workshops/python-tensorflow/activity-1/>- Activity 1 - Importing the TensorFlow library and datasets</option>
<option value=/workshops/python-tensorflow/activity-2/>- Activity 2 - Displaying RGB Color Values for Images</option>
<option value=/workshops/python-tensorflow/progress_update_1/>- Progress Update 1</option>
<option value=/workshops/python-tensorflow/activity-3/>- Activity 3 - Displaying Clothing Samples</option>
<option value=/workshops/python-tensorflow/building_neural_network/>- Building the Neural Network</option>
<option value=/workshops/python-tensorflow/activity-4/>- Activity 4 - Training the Model</option>
<option value=/workshops/python-tensorflow/activity-5/>- Activity 5 - Testing the Model</option>
<option value=/workshops/python-tensorflow/activity-6/>- Activity 6 - Testing the Model (Again!)</option>
<option value=/workshops/python-tensorflow/progress_update_2/>- Progress Update 2</option>
<option value=/workshops/python-tensorflow/plotting_model/ selected>- Plotting the Model and its Predictions</option>
<option value=/workshops/python-tensorflow/activity-7/>- Activity 7 - Plotting an Image's predicted Category</option>
<option value=/workshops/python-tensorflow/progress_update_3/>- Progress Update 3</option>
<option value=/workshops/python-tensorflow/wrapup/>- Workshop Conclusion</option></select></div><h1>Plotting the Model and its Predictions</h1><div class="panel panel-primary"><div class=panel-heading>Workshop Resources</div><div class=panel-body><div class=metadata-row><span class=metadata-label>Pre-requisite:</span>
<span class=metadata-value>Python Basics: Functions- Built in Functions, Functions from libraries; Data Types- Strings, Numbers, Reading from Console; Data Structures- Lists, Tuples, Sets; Loops- For Loops</span></div><div class=metadata-row><span class=metadata-label>Difficulty:</span>
<span class=metadata-value>Intermediate</span></div></div></div><iframe width=100% height=600px src=https://www.youtube.com/embed/FrO66fkSU7M frameborder=0 allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></br></br><p>Now that we are able to classify the category of an individual piece of clothing using our model, we will visualize these predictions by creating a bar plot for a specified image.</p><h2 id=predicated-classification>Predicated Classification</h2><p>The <code>plot_image</code> function displays an image along with its predicted classification, the confidence level of the model for that category, and the actual classification (which is for reference).</p><div class="notices tip"><p header-value=Tip><p>A <strong>confidence level</strong> is used to convey how confident or certain we are in our answer being correct. If you have to predict whether it will rain tomorrow, your possible answers are yes or no. What if you&rsquo;re not totally certain in your answer, though? If the weather reporter predicted rain for tomorrow, you may say you are 90% confident. This means that you are pretty sure it will rain tomorrow, but it also tells us that you think there is a 10% chance you may be wrong.</p><p>A smaller confidence level indicates you are less certain in your answer being correct, that you are likely to be wrong or incorrect in some capacity. The closer to 100 our confidence level is, the more certain we are in our prediction.</p></p></div><p>Copy the <code>plot_image</code> function into your Google Colab Notebook:</br></p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_image</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions_array</span><span style=color:#111>,</span> <span style=color:#111>true_label</span><span style=color:#111>,</span> <span style=color:#111>img</span><span style=color:#111>)</span><span style=color:#111>:</span>
  <span style=color:#111>true_label</span><span style=color:#111>,</span> <span style=color:#111>img</span> <span style=color:#f92672>=</span> <span style=color:#111>true_label</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>img</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>grid</span><span style=color:#111>(</span><span style=color:#111>False</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>xticks</span><span style=color:#111>(</span><span style=color:#111>[</span><span style=color:#111>]</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>yticks</span><span style=color:#111>(</span><span style=color:#111>[</span><span style=color:#111>]</span><span style=color:#111>)</span>

  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>imshow</span><span style=color:#111>(</span><span style=color:#111>img</span><span style=color:#111>,</span> <span style=color:#111>cmap</span><span style=color:#f92672>=</span><span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>cm</span><span style=color:#f92672>.</span><span style=color:#111>binary</span><span style=color:#111>)</span>

  <span style=color:#111>predicted_label</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>argmax</span><span style=color:#111>(</span><span style=color:#111>predictions_array</span><span style=color:#111>)</span>
  <span style=color:#00a8c8>if</span> <span style=color:#111>predicted_label</span> <span style=color:#f92672>==</span> <span style=color:#111>true_label</span><span style=color:#111>:</span>
    <span style=color:#111>color</span> <span style=color:#f92672>=</span> <span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>blue</span><span style=color:#d88200>&#39;</span>
  <span style=color:#00a8c8>else</span><span style=color:#111>:</span>
    <span style=color:#111>color</span> <span style=color:#f92672>=</span> <span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>red</span><span style=color:#d88200>&#39;</span>

  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>xlabel</span><span style=color:#111>(</span><span style=color:#d88200></span><span style=color:#d88200>&#34;</span><span style=color:#d88200>{} {:2.0f}</span><span style=color:#d88200>%</span><span style=color:#d88200> ({})</span><span style=color:#d88200>&#34;</span><span style=color:#f92672>.</span><span style=color:#111>format</span><span style=color:#111>(</span><span style=color:#111>class_names</span><span style=color:#111>[</span><span style=color:#111>predicted_label</span><span style=color:#111>]</span><span style=color:#111>,</span>
                                <span style=color:#ae81ff>100</span><span style=color:#f92672>*</span><span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>predictions_array</span><span style=color:#111>)</span><span style=color:#111>,</span>
                                <span style=color:#111>class_names</span><span style=color:#111>[</span><span style=color:#111>true_label</span><span style=color:#111>]</span><span style=color:#111>)</span><span style=color:#111>,</span>
                                <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#111>color</span><span style=color:#111>)</span>
</code></pre></div><h2 id=visualizing-confidence-values>Visualizing Confidence Values</h2><p>The <code>plot_value_array</code> function plots the confidence values generated by the model as a bar graph.</p><p>The y-axis of the graph will display the confidence level, while the x-axis of the graph will represent the categorization of items (t-shirt/top, trouser, pullover, dress, coat, sandal, shirt, sneaker, bag, or ankle boot).</p><p>Copy the <code>plot_value_array</code> function into your Google Colab Notebook:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00a8c8>def</span> <span style=color:#75af00>plot_value_array</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions_array</span><span style=color:#111>,</span> <span style=color:#111>true_label</span><span style=color:#111>)</span><span style=color:#111>:</span>
  <span style=color:#111>true_label</span> <span style=color:#f92672>=</span> <span style=color:#111>true_label</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>grid</span><span style=color:#111>(</span><span style=color:#111>False</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>xticks</span><span style=color:#111>(</span><span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>10</span><span style=color:#111>)</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>yticks</span><span style=color:#111>(</span><span style=color:#111>[</span><span style=color:#111>]</span><span style=color:#111>)</span>
  <span style=color:#111>thisplot</span> <span style=color:#f92672>=</span> <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>bar</span><span style=color:#111>(</span><span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#ae81ff>10</span><span style=color:#111>)</span><span style=color:#111>,</span> <span style=color:#111>predictions_array</span><span style=color:#111>,</span> <span style=color:#111>color</span><span style=color:#f92672>=</span><span style=color:#d88200></span><span style=color:#d88200>&#34;</span><span style=color:#d88200>#777777</span><span style=color:#d88200>&#34;</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>ylim</span><span style=color:#111>(</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#111>)</span>
  <span style=color:#111>predicted_label</span> <span style=color:#f92672>=</span> <span style=color:#111>np</span><span style=color:#f92672>.</span><span style=color:#111>argmax</span><span style=color:#111>(</span><span style=color:#111>predictions_array</span><span style=color:#111>)</span>

  <span style=color:#111>thisplot</span><span style=color:#111>[</span><span style=color:#111>predicted_label</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>set_color</span><span style=color:#111>(</span><span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>red</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
  <span style=color:#111>thisplot</span><span style=color:#111>[</span><span style=color:#111>true_label</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>set_color</span><span style=color:#111>(</span><span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>blue</span><span style=color:#d88200>&#39;</span><span style=color:#111>)</span>
</code></pre></div><h2 id=using-the-functions>Using the Functions</h2><p>We will use the following code to call on the functions we wrote previously. Copy the snippet into your Google Colab Notebook.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>   
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>figure</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>)</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
<span style=color:#111>plot_image</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>test_labels</span><span style=color:#111>,</span> <span style=color:#111>test_images</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span>
<span style=color:#111>plot_value_array</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span>  <span style=color:#111>test_labels</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>show</span><span style=color:#111>(</span><span style=color:#111>)</span>
</code></pre></div><p><img src=../media/Plotting_fig1.png alt="Plotting Model Figure 1 of an ankle boot"></p><p>We can see that our model predicts this item to be an ankle boot. How confident is the model in this prediction? 99% confident. The category in paranthesis is the correct categorization of the item. In this case, the model detected the item correctly.</br></br>Keep in mind that not all models are perfect. Models can get their predictions wrong as we will see in the next example.</br></p><p>We will use the same code as before, but test the confidence with a different item. Set <code>i</code> equal to a new value, like 12.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span> 
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>figure</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>6</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>)</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
<span style=color:#111>plot_image</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>test_labels</span><span style=color:#111>,</span> <span style=color:#111>test_images</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span>
<span style=color:#111>plot_value_array</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span>  <span style=color:#111>test_labels</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>show</span><span style=color:#111>(</span><span style=color:#111>)</span>
</code></pre></div><p><img src=../media/Plotting_fig2.png alt="Plotting Model Figure 2 of a sneaker"></p><p>From this example we see that the model predicted the item to be a sandal with 96% confidence. However, we see that the correct identification of the item is a sneaker. The plot shows that the model also predicted this item to be a sneaker with ~ 3% confidence or an ankle boot with ~ 1% confidence.</p><h2 id=more-examples>More Examples</h2><p>For more examples of the model predictions, plot the first 25 test images, their predicted labels, and the true labels. As before, the correct predictions will be shown in blue and the incorrect predictions in red.</p><p>Copy this code into your Google Colab Notebook:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>num_rows</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
<span style=color:#111>num_cols</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
<span style=color:#111>num_images</span> <span style=color:#f92672>=</span> <span style=color:#111>num_rows</span><span style=color:#f92672>*</span><span style=color:#111>num_cols</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>figure</span><span style=color:#111>(</span><span style=color:#111>figsize</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>num_cols</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>num_rows</span><span style=color:#111>)</span><span style=color:#111>)</span>
<span style=color:#00a8c8>for</span> <span style=color:#111>i</span> <span style=color:#f92672>in</span> <span style=color:#111>range</span><span style=color:#111>(</span><span style=color:#111>num_images</span><span style=color:#111>)</span><span style=color:#111>:</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#111>num_rows</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>num_cols</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span>
  <span style=color:#111>plot_image</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>test_labels</span><span style=color:#111>,</span> <span style=color:#111>test_images</span><span style=color:#111>)</span>
  <span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>subplot</span><span style=color:#111>(</span><span style=color:#111>num_rows</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>num_cols</span><span style=color:#111>,</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span>
  <span style=color:#111>plot_value_array</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>predictions</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>test_labels</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>tight_layout</span><span style=color:#111>(</span><span style=color:#111>)</span>
<span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>show</span><span style=color:#111>(</span><span style=color:#111>)</span>
</code></pre></div><p><img src=../media/Plotting_fig3.png alt="Plotting Model Figure 3, 5x5 images and their model predictions"></p><p>What do you think about the model&rsquo;s predictions? Would you be satisfied with this success rate?</p><div class=chevrons><style>.workshop-complete-image{margin:40px auto 50px;width:340.8px}.workshop-complete-words{font-family:Space Mono,monospace;font-weight:700;font-size:48px;line-height:71px;text-align:center}.horizontal-bar{background-color:#000;width:120px;height:12px;margin:80px auto 0}</style><div id=navigation><div class=next-prev-wrapper-div><a class="nav nav-prev" href=https://nuevofoundation.github.io/workshops/python-tensorflow/progress_update_2/ title="Progress Update 2"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Previous:</div><div class=nextprevbutton-subsection-name>Progress Update 2</div><div class=nextprevbutton-horizontal-bar></div></div><div class=prevbutton-image><i class="fa fa-arrow-left"></i></div></div></a></div><div class=next-prev-wrapper-div><a class="nav nav-next" href=https://nuevofoundation.github.io/workshops/python-tensorflow/activity-7/ title="Activity 7 - Plotting an Image's predicted Category"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Up Next:</div><div class=nextprevbutton-subsection-name>Activity 7 - Plotting an Image's predicted Category</div><div class=nextprevbutton-horizontal-bar></div></div><div class=nextbutton-image><i class="fa fa-arrow-right"></i></div></div></a></div></div></div></section></article><footer><div class=footline><div class=date><i class="fa fa-calendar"></i>Wed, 09 Sep 2020 16:19:17 PDT</div><div class=github-link><a href=https://github.com/NuevoFoundation/workshops/tree/master/content/python-tensorflow/plotting_model.md target=blank><i class="fa fa-code-fork"></i></a></div></div><div></div></footer><script src=/workshops/js/clipboard.min.js></script><link href=/workshops/css/featherlight.min.css rel=stylesheet><script src=/workshops/js/featherlight.min.js></script><script src=/workshops/theme-flex/script.js></script><div id=footer class=row><div class=col-xs-12><div class=App-footer><div class=App-footer-big>Join the conversation on social media.</div><div class=social-images><a target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Instagram" class="fab fa-2x fa-instagram"></i></a><a target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Twitter" class="fab fa-2x fa-twitter"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Facebook" class="fab fa-2x fa-1x fa-facebook-f"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-2x fa-linkedin"></i></a><a target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1" class=footer-pics><i aria-label="Nuevo Foundation YouTube" class="fab fa-2x fa-youtube"></i></a><a target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Github" class="fab fa-2x fa-github"></i></a></div><div class=App-footer-small>© Copyright 2022, All Rights Reserved by Nuevo Foundation, a 501(c)(3) nonprofit.</div></div></div></div></body></html>