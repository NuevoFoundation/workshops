<!doctype html><html><head><title>Nuevo Foundation Workshops</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#000000"><meta name=revised content="2023-03-31T22:51:13 UTC"><meta name=application-name content="Â "><meta name=msapplication-TileColor content="#FFFFFF"><meta name=msapplication-TileImage content="mstile-144x144.png"><meta name=msapplication-square70x70logo content="mstile-70x70.png"><meta name=msapplication-square150x150logo content="mstile-150x150.png"><meta name=msapplication-wide310x150logo content="mstile-310x150.png"><meta name=msapplication-square310x310logo content="mstile-310x310.png"><title>Step 1 - Finding the problem (Part 3) :: Nuevo Foundation Workshops</title><link rel="shortcut icon" href=/workshops/images/favicon.png type=image/x-icon><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css rel=stylesheet><link href=/workshops/css/nucleus.css rel=stylesheet><link href=/workshops/theme-flex/style.css rel=stylesheet><link rel="shortcut icon" href=https://www.nuevofoundation.org/favicons/favicon.ico><link rel=apple-touch-icon-precomposed sizes=57x57 href=https://www.nuevofoundation.org/favicons//apple-touch-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=./favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=https://www.nuevofoundation.org/favicons/pple-touch-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-152x152.png><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-128.png sizes=128x128><link href="https://fonts.googleapis.com/css?family=Space+Mono:700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.3.5/dist/css/bootstrap.min.css><link type=text/css rel=stylesheet href=/workshops/css/nuevoweb.css><link rel=stylesheet href=/workshops/css/chunk.css><link rel=stylesheet href=/workshops/css/data-style.css><script src=/workshops/js/jquery-2.x.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script type=text/javascript>var baseurl="https:\/\/nuevofoundation.github.io\/workshops\/";</script><script lang=javascript>function toggleVisibility(){const menu=document.getElementById("mobile-nav-menu");if(menu.style.display=='none'){menu.classList.replace("transition-out","transition-in")
menu.style.display='block';}
else if(menu.style.display=='block'){menu.classList.replace("transition-in","transition-out")
menu.style.display='none';}}</script><meta name=description content></head><body data-url=/workshops/debugging/04-identify-the-problem3/><header><div id=mobile-nav-menu class=transition-out style=display:none><div class=close-btn onclick=toggleVisibility();><i aria-hidden=true focusable=false style=cursor:pointer class="fa fa-times fa-w-11 fa-sm"></i></div><div><div class="sc-dNLxif ecnYUM"><a href=/support-us><button class="sc-jbKcbu sedGx" style="background-color:#fff;color:#000;border:4px solid #000;border-radius:4px">
Donate</button></a></div></div><hr><div><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/what-we-do><ul class="sc-uJMKN fRSLiB"><li>What We Do</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/get-involved><ul class="sc-uJMKN fRSLiB"><li>Get Involved</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/support-us><ul class="sc-uJMKN fRSLiB"><li>Support us</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/blog><ul class="sc-uJMKN fRSLiB"><li>Event blog</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/about-us><ul class="sc-uJMKN fRSLiB"><li>Our team</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/contact><ul class="sc-uJMKN fRSLiB"><li>Contact us</li></ul></a></div></div><div><div class="sc-gGBfsJ iKkPGj"><div class=container-fluid><div id=toprow class=row><div class=col-xs-12><div class="sc-EHOje fJMnSm"><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation><i aria-label="Nuevo Foundation Instagram" class="fab fa-instagram"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation><i aria-label="Nuevo Foundation Twitter" class="fab fa-twitter"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation><i aria-label="Nuevo Foundation Facebook" class="fab fa-facebook-f"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-linkedin"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1n"><i aria-label="Nuevo Foundation YouTube" class="fab fa-youtube"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation><i aria-label="Nuevo Foundation Github" class="fab fa-github"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" rel="noopener noreferrer" href=https://nuevofoundation.org/support-us>Donate</a></div></div></div></div><div id=secondrow class=row><div class="col-sm-12 hidden-xs"><div class="sc-htoDjs kjtfZK"><a class="sc-fjdhpX izNzAG active" aria-current=page href=https://nuevofoundation.org><img alt="Nuevo Foundation Logo" src=/workshops/images/Logo_long.0f097b90.svg height=60px></a><ul class="sc-iwsKbI bUOvG"><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/what-we-do><li class="sc-gZMcBi Bomeo">What We Do</li></a><a class=izNzAG href=/><li class="sc-gZMcBi Bomeo-selected jgBGVn">Workshops<span></span></li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/get-involved><li class="sc-gZMcBi Bomeo">Get Involved</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/support-us><li class="sc-gZMcBi Bomeo">Support us</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/blog><li class="sc-gZMcBi Bomeo">Event blog</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/about-us><li class="sc-gZMcBi Bomeo">Our team</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/contact><li class="sc-gZMcBi Bomeo">Contact us</li></a></ul></div></div><div class="hidden-lg hidden-md hidden-sm col-xs-12"><div class=row><div class=col-xs-10><a class="sc-fjdhpX izNzAG active" aria-current=page href=/><img alt="Nuevo Foundation Logo" class="sc-dnqmqq emolVn" src=/workshops/images/Logo_long.0f097b90.svg height=60%></a></div><div class=col-xs-2 onclick=toggleVisibility(); style=padding-top:4%;padding-left:4%;cursor:pointer><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 fa-lg" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></div></div></div></div></div></div></header><article><aside><ul class=menu><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/ class="dd-item parent haschildren"><div><a href=/workshops/debugging/>C: The Debugging Process</a>
<i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/01-overview/ class=dd-item><div><a href=/workshops/debugging/01-overview/>An Overview of Debugging
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/02-identify-the-problem1/ class=dd-item><div><a href=/workshops/debugging/02-identify-the-problem1/>Step 1 - Finding the problem (Part 1)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/03-identify-the-problem2/ class=dd-item><div><a href=/workshops/debugging/03-identify-the-problem2/>Step 1 - Finding the problem (Part 2)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/04-identify-the-problem3/ class="dd-item active"><div><a href=/workshops/debugging/04-identify-the-problem3/>Step 1 - Finding the problem (Part 3)
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/05-fixing-the-problem/ class=dd-item><div><a href=/workshops/debugging/05-fixing-the-problem/>Step 2 - Fixing the problem
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/06-testing/ class=dd-item><div><a href=/workshops/debugging/06-testing/>Step 3 - Testing
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/e1-binary-tree/ class=dd-item><div><a href=/workshops/debugging/e1-binary-tree/>Exercise 1 - Binary Tree Implementation
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/e2-binary-heap/ class=dd-item><div><a href=/workshops/debugging/e2-binary-heap/>Exercise 2 - Binary Heap Implementation
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/debugging/e3-burrows-wheeler-transform/ class=dd-item><div><a href=/workshops/debugging/e3-burrows-wheeler-transform/>Exercise 3 - The Burrows-Wheeler Transform
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li></ul><section></section></aside><section class=page><div align=right><select id=select-language onchange="location=this.value;">
<option id=en value=https://nuevofoundation.github.io/workshops/debugging/04-identify-the-problem3/ selected>English</option></select></div><div class=nav-select>Navigation:&nbsp;
<select onchange="location.href=this.value;">
<option value=/workshops/debugging/>C: The Debugging Process</option>
<option value=/workshops/debugging/01-overview/>- An Overview of Debugging</option>
<option value=/workshops/debugging/02-identify-the-problem1/>- Step 1 - Finding the problem (Part 1)</option>
<option value=/workshops/debugging/03-identify-the-problem2/>- Step 1 - Finding the problem (Part 2)</option>
<option value=/workshops/debugging/04-identify-the-problem3/ selected>- Step 1 - Finding the problem (Part 3)</option>
<option value=/workshops/debugging/05-fixing-the-problem/>- Step 2 - Fixing the problem</option>
<option value=/workshops/debugging/06-testing/>- Step 3 - Testing</option>
<option value=/workshops/debugging/e1-binary-tree/>- Exercise 1 - Binary Tree Implementation</option>
<option value=/workshops/debugging/e2-binary-heap/>- Exercise 2 - Binary Heap Implementation</option>
<option value=/workshops/debugging/e3-burrows-wheeler-transform/>- Exercise 3 - The Burrows-Wheeler Transform</option></select></div><h1>Step 1 - Finding the problem (Part 3)</h1><div class="panel panel-primary"><div class=panel-heading>Workshop Resources</div><div class=panel-body><div class=metadata-row><span class=metadata-label>Difficulty:</span>
<span class=metadata-value>Intermediate</span></div></div></div><h2 id=debuggers>Debuggers</h2><p>Debugging code is such a widespread, common problem that people have built entire programs designed to help other programmers debug more efficiently. These are suitably named <strong>debuggers</strong>, and there are plenty of debuggers that work for the C programming language. Let&rsquo;s take a look at <code>gdb</code>, a common debugger used with the command line.</p><p><a class="my-2 mx-4 btn btn-info" href=https://replit.com/@nuevofoundation/Debugging-Samples-C target=_blank>Launch Replit</a></p><p>For our examples, we will make use of the <a href="https://www.youtube.com/watch?v=SLauY6PpjW4" target=_blank>Quicksort</a> algorithm.</p><p><strong>Quicksort</strong> is an algorithm that sorts an array by first selecting an element in the array as a <code>pivot</code>.</p><p>Next, the elements are organized based on one of the following conditions:</p><ul><li>Elements lower than the pivot.</li><li>Elements greater than the pivot.</li></ul><p>When the sorting is done, the same process is recursively called in the upper and lower partitions of the array, taking the pivot as the middle point.</p><div class="notices note"><p header-value=Note>Our version of quicksort assumes the leftmost element is the &ldquo;greater&rdquo; element and the rightmost element is the pivot within the partition.</p></div><table><thead><tr><th align=center><img src=../resources/debugging_process_quicksort.svg alt="Quicksort using pivot as the rightmost element."></th></tr></thead><tbody><tr><td align=center>Figure 1: Quicksort using the rightmost element as the pivot and assuming the leftmost element is the &ldquo;greater&rdquo; element.</td></tr></tbody></table><p><a href=https://sourceware.org/gdb/ target=_blank>GDB (GNU Project Debugger)<sup><span class="glyphicon glyphicon-new-window" aria-hidden=true></span></sup></a>
is a powerful debugger that lets you debug programs from the command line, which is useful in cases where you donât have access to a GUI (Graphical User Interface).</p><p>It is important to understand how the program works to do effective debugging. Our &lsquo;quicksort&rsquo; implementation runs a recursive implementation of quicksort and performs the sorting if the element is lesser than the pivot and assuming the first element is the &ldquo;greater&rdquo; element. The sorting itself occurs in the <code>partition</code> function.</p><p>Open the <strong>Shell</strong> tab and compile the program:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>make Quicksort
</code></pre></div><div class="notices note"><p header-value=Note><p>When the program is compiled, the flags: <code>-g</code> and <code>-Og</code> are used. The first one tells the compiler to add <strong>debugging information</strong>, meaning that without that flag, gdb would not be able to debug the program. The second tells the compiler to optimize the program in a way that wouldn&rsquo;t affect the program&rsquo;s run structure. Without <code>-Og</code>, the compiler could potentially optimize away some of your code, so a debugger would not be nearly as effective.</p><p>It is important to keep note of the second flag. For debugging, you should <strong>ALWAYS</strong> make sure the compiler makes minimal optimizations to your code because optimizations could drastically change how the code is run!</p></p></div><p>Run <code>gdb examples/Quicksort</code>. This will open the GDB command line interface. To debug a program with <code>gdb</code> you can use <code>gdb &lt;name of program></code>.</p><p>You should see something like this:</p><table><thead><tr><th align=center><img src=../resources/w4-01.png alt="Running GDB on &lsquo;Quicksort&rsquo; file."></th></tr></thead><tbody><tr><td align=center>Figure 2: Running GDB on &lsquo;Quicksort&rsquo; file.</td></tr></tbody></table><p>Make sure that GDB says that it is <code>Reading symbols from ./examples/Quicksort...</code>, otherwise you didn&rsquo;t attach the program to GDB. You can exit GDB by entering the command <code>quit</code> (or any of its prefixes: <code>q</code> works) as if it were the normal shell command line.</p><p>To debug the program, we need to run it from GDB. Enter the command <code>run</code> (or <code>r</code>). This will execute the program as if you&rsquo;d run it from the normal command line.</p><p>The program first prints the contents of the array to be sorted: an array of unordered numbers. Next, it runs the sort algorithm, and finally, prints out the array sorted array. You can see how the array is shifted during the sort!</p><p>However, it seems that the sorting is not happening as intended.</p><p>Let&rsquo;s use one of the most important tools debuggers offer: <strong>breakpoints</strong>. A breakpoint tells the debugger to pause the program whenever it reaches that line of code as it is executing. This enables you to take a look at what is happening within the program in real-time. Note that the debugger does not run the line of code the breakpoint is on until after you continue executing the program.</p><p>To create a breakpoint in GDB, use the following command syntax:
<code>break &lt;filename:line></code>. For example, to create a breakpoint on line 15 in the <strong>quicksort.c</strong> file, use the following command:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#111>break</span> quicksort.c:27
</code></pre></div><p>If you try running the program now using <code>run</code>, the program will halt when it reaches the breakpoint on line 20, and show you some information about the program, such as the line of code it is stopping on.</p><p>While the program is paused, you can see the values of variables. We can use the <code>print</code> command to evaluate an expression and print it.</p><p>For instance, <code>print high</code> will print the variable <code>high</code>. You can get more elaborate than that by using entire expressions - <code>print hi + 2</code> will evaluate <code>hi + 2</code> and print it.</p><p>You can manually step through your code by calling <code>next</code> (or <code>n</code>), which will tell the debugger to advance to the next line of code <strong>without jumping into a function call</strong>. The <code>step</code> command will move the debugger to the first line of code in a function call.</p><p>You can try it out by creating a breakpoint within the <code>partition</code> function, and try either using <code>next</code> or <code>step</code> to see which line of code you&rsquo;ll land on next.</p><p>If you want to have your code continue running until the next breakpoint, you can use the <code>continue</code> (or <code>c</code>) command. Finally, to delete a breakpoint, you can use the <code>delete</code> (or <code>d</code>) command followed by the breakpoint number, which you see when you set the breakpoint.</p><p>Another useful command to know is <code>bt</code> or <code>backtrace</code>. This shows you the calling stack, or which functions were called to get to the line of code the program is halted on.</p><p>This can help track the execution order. It also works well to find out how a program crashed by seeing the functions that led up to the crash.</p><p>There are plenty of commands GDB offers. We recommend using a cheat sheet that you can find online.</p><ul><li><a href=https://gist.github.com/rkubik/b96c23bd8ed58333de37f2b8cd052c30 target=_blank>Reference 1<sup><span class="glyphicon glyphicon-new-window" aria-hidden=true></span></sup></a></li><li><a href=https://cs.brown.edu/courses/cs033/docs/guides/gdb.pdf target=_blank>Reference 2<sup><span class="glyphicon glyphicon-new-window" aria-hidden=true></span></sup></a></li></ul><h3 id=placing-breakpoints-effectively>Placing Breakpoints Effectively</h3><p>First let&rsquo;s identify where all of the element sorting takes place. Do you know where the sorting is happening?</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fa fa-chevron-down':'fa fa-chevron-right';});});"><i style=font-size:x-small class="fa fa-chevron-right"></i><span><em><strong>Answer</strong></em></span></div><div class=expand-content style=display:none><p>The sorting takes place within the <code>for</code> loop and at the end of the process when the pivot is changed with the &ldquo;greater&rdquo; element.</p></div></div><br><p>Place a breakpoint inside the <code>for</code> loop and run the program:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> <span style=color:#111>break</span> quicksort.c:27
<span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> run 
</code></pre></div><p>You need to find the faulty variables that cause your program to not work as expected. Try and see if you can spot the problem!</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fa fa-chevron-down':'fa fa-chevron-right';});});"><i style=font-size:x-small class="fa fa-chevron-right"></i><span><em><strong>Hint: Keep an eye on how the variables in the loop change.</strong></em></span></div><div class=expand-content style=display:none><p><p>Since we placed the breakpoint inside the loop, on each iteration we should see the values <code>p1</code> and <code>p2</code> change.</p><p>Try printing these variables each time the debugger stops your code.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> disp p1
<span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> disp p2
</code></pre></div></p></div></div><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fa fa-chevron-down':'fa fa-chevron-right';});});"><i style=font-size:x-small class="fa fa-chevron-right"></i><span><em><strong>Answer</strong></em></span></div><div class=expand-content style=display:none><p><p>The <code>p1</code> variable is not being increased when a number lesser than the pivot is found. Remember that our version will assume that each time a lesser element is found the pointer for the greater element must be updated</p><p>Add <code>p1++;</code> after the <code>swap</code> statement in line 27.</p><table><thead><tr><th align=center><img src=../resources/debugging_process_fixing_quicksort.svg alt="Fixing our quicksort algorithm."></th></tr></thead><tbody><tr><td align=center>Figure 3: Fixing our quicksort algorithm.</td></tr></tbody></table></p></div></div><br><p>Note that all debuggers should have the same basic concepts: they allow you to step through your code as it runs, in real-time. You should almost always use debuggers over print statements. You won&rsquo;t regret it!</p><h2 id=another-type-of-bug-memory-errors>Another Type of Bug: Memory Errors</h2><p>A C/C++âs nightmare, memory errors are one of the most frustrating kinds of bugs that exist. Failing to address them can result in undefined behavior (non-replicable bugs!) and memory leaks. Thus, fixing them is a huge priority.</p><div class="notices note"><p header-value=Note>A memory leak happens when your program allocates memory using malloc or calloc (or other memory allocation calls), and doesnât free it. The memory is âlostâ - thereâs no (easy) way to retrieve it until the program terminates.</p></div><p>Luckily, people have also written programs to help you find memory errors, and one of these programs is <code>valgrind</code>. Valgrind is a tool that not only looks for memory errors, but shows you exactly where the errors occur in your code.
Letâs use valgrind to find where memory errors occur. As an example, we have a rudimentary implementation of a vector in C, which is the C++ standard libraryâs version of a dynamically sized array.</p><p><a class="my-2 mx-4 btn btn-info" href=https://replit.com/@nuevofoundation/Debugging-Samples-C target=_blank>Launch Replit</a></p><p>First make the program using</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>make Vector
</code></pre></div><p>Now run it using</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>examples/Vector
</code></pre></div><p>Notice that there&rsquo;s an error called a &lsquo;double free&rsquo;! This is a type of memory caused by calling <code>free</code> to a pointer twice.</p><p>Now instead of using gdb, use valgrind to check how memory is allocated and used. Run the command:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>valgrind --tool<span style=color:#f92672>=</span>memcheck leak-check<span style=color:#f92672>=</span>full examples/Vector
</code></pre></div><p>It should be apparent valgrind caught some errors, perhaps related to the double free (notice the <code>ERROR SUMMARY</code> at the bottom has a few errors detected!).</p><p>Let&rsquo;s take a look at some of the errors.</p><p><img src=../resources/w4-02.png alt="Valgrind error 1"></p><p>The error shown above is called an invalid read, which is often because you are reading memory that was free&rsquo;d in another block. Valgrind lets you see where the memory is free&rsquo;d and alloc&rsquo;d:</p><p><img src=../resources/w4-03.png alt="Valgrind error 2"></p><p>The block of memory was allocated by the <code>malloc</code> function in <code>createVectorInt</code>, which was called in the <code>main</code> function. The block was <code>free</code>'d by the <code>free</code> function called in the <code>pushBack</code> function.</p><p>Finally, in the heap summary, you can see that there were 96 bytes that were &lsquo;lost&rsquo; - in other words, there was a memory leak. This happened because we forgot to call <code>deleteVectorInt</code> on the vector at the end of the main function.</p><p><img src=../resources/w4-04.png alt="Valgrind error 3"></p><p>Valgrind provides a plethora of information that you can use to hunt down memory errors in your C and C++ programs. It not only informs you of where errors are happening, but also where memory blocks are allocated and subsequently free&rsquo;d (or not free&rsquo;d, in the case of a memory leak). Can you find the bug that causes all the invalid reads in the vector example?</p><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fa fa-chevron-down':'fa fa-chevron-right';});});"><i style=font-size:x-small class="fa fa-chevron-right"></i><span><em>Click to show answer</em></span></div><div class=expand-content style=display:none><p>Notice that when we are reallocating the array, we forgot to update <code>list->__arr</code>! This means that we writing to a pointer that was free&rsquo;d, which explains the invalid reads and writes we see on Valgrind, the double frees (since we call free on that already free&rsquo;d pointer), and the memory leaks (since we never refer to the newly allocated arrays ever again)! All you need to do is set that pointer to the new updated array, which should fix the error.</p></div></div><br><p>In the exercises, you will be required to fix any memory errors that appear.</p><div class=chevrons><style>.workshop-complete-image{margin:40px auto 50px;width:340.8px}.workshop-complete-words{font-family:Space Mono,monospace;font-weight:700;font-size:48px;line-height:71px;text-align:center}.horizontal-bar{background-color:#000;width:120px;height:12px;margin:80px auto 0}</style><div id=navigation><div class=next-prev-wrapper-div><a class="nav nav-prev" href=https://nuevofoundation.github.io/workshops/debugging/03-identify-the-problem2/ title="Step 1 - Finding the problem (Part 2)"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Previous:</div><div class=nextprevbutton-subsection-name>Step 1 - Finding the problem (Part 2)</div><div class=nextprevbutton-horizontal-bar></div></div><div class=prevbutton-image><i class="fa fa-arrow-left"></i></div></div></a></div><div class=next-prev-wrapper-div><a class="nav nav-next" href=https://nuevofoundation.github.io/workshops/debugging/05-fixing-the-problem/ title="Step 2 - Fixing the problem"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Up Next:</div><div class=nextprevbutton-subsection-name>Step 2 - Fixing the problem</div><div class=nextprevbutton-horizontal-bar></div></div><div class=nextbutton-image><i class="fa fa-arrow-right"></i></div></div></a></div></div></div></section></article><footer><div class=footline><div class=github-link><a href=https://github.com/NuevoFoundation/workshops/tree/master/content/debugging/04-identify-the-problem3.md target=blank><i class="fa fa-code-fork"></i></a></div></div><div></div></footer><script src=/workshops/js/clipboard.min.js></script><link href=/workshops/css/featherlight.min.css rel=stylesheet><script src=/workshops/js/featherlight.min.js></script><script src=/workshops/theme-flex/script.js></script><div id=footer class=row><div class=col-xs-12><div class=App-footer><div class=App-footer-big>Join the conversation on social media.</div><div class=social-images><a target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Instagram" class="fab fa-2x fa-instagram"></i></a><a target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Twitter" class="fab fa-2x fa-twitter"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Facebook" class="fab fa-2x fa-1x fa-facebook-f"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-2x fa-linkedin"></i></a><a target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1" class=footer-pics><i aria-label="Nuevo Foundation YouTube" class="fab fa-2x fa-youtube"></i></a><a target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Github" class="fab fa-2x fa-github"></i></a></div><div class=App-footer-small>Â© Copyright 2022, All Rights Reserved by Nuevo Foundation, a 501(c)(3) nonprofit.</div></div></div></div></body></html>