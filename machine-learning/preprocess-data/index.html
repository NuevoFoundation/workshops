<!doctype html><html><head><title>Nuevo Foundation Workshops</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#000000"><meta name=revised content="2023-01-26T01:16:27 UTC"><meta name=application-name content=" "><meta name=msapplication-TileColor content="#FFFFFF"><meta name=msapplication-TileImage content="mstile-144x144.png"><meta name=msapplication-square70x70logo content="mstile-70x70.png"><meta name=msapplication-square150x150logo content="mstile-150x150.png"><meta name=msapplication-wide310x150logo content="mstile-310x150.png"><meta name=msapplication-square310x310logo content="mstile-310x310.png"><title>Step 4: Pre-process data :: Nuevo Foundation Workshops</title><link rel="shortcut icon" href=/workshops/images/favicon.png type=image/x-icon><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css rel=stylesheet><link href=/workshops/css/nucleus.css rel=stylesheet><link href=/workshops/theme-flex/style.css rel=stylesheet><link rel="shortcut icon" href=https://www.nuevofoundation.org/favicons/favicon.ico><link rel=apple-touch-icon-precomposed sizes=57x57 href=https://www.nuevofoundation.org/favicons//apple-touch-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=./favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=https://www.nuevofoundation.org/favicons/pple-touch-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=https://www.nuevofoundation.org/favicons/apple-touch-icon-152x152.png><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://www.nuevofoundation.org/favicons/favicon-128.png sizes=128x128><link href="https://fonts.googleapis.com/css?family=Space+Mono:700&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.3.5/dist/css/bootstrap.min.css><link type=text/css rel=stylesheet href=/workshops/css/nuevoweb.css><link rel=stylesheet href=/workshops/css/chunk.css><link rel=stylesheet href=/workshops/css/data-style.css><script src=/workshops/js/jquery-2.x.min.js></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script type=text/javascript>var baseurl="https:\/\/nuevofoundation.github.io\/workshops\/";</script><script lang=javascript>function toggleVisibility(){const menu=document.getElementById("mobile-nav-menu");if(menu.style.display=='none'){menu.classList.replace("transition-out","transition-in")
menu.style.display='block';}
else if(menu.style.display=='block'){menu.classList.replace("transition-in","transition-out")
menu.style.display='none';}}</script><meta name=description content="Basics of Machine Learning"></head><body data-url=/workshops/machine-learning/preprocess-data/><header><div id=mobile-nav-menu class=transition-out style=display:none><div class=close-btn onclick=toggleVisibility();><i aria-hidden=true focusable=false style=cursor:pointer class="fa fa-times fa-w-11 fa-sm"></i></div><div><div class="sc-dNLxif ecnYUM"><a href=/support-us><button class="sc-jbKcbu sedGx" style="background-color:#fff;color:#000;border:4px solid #000;border-radius:4px">
Donate</button></a></div></div><hr><div><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/what-we-do><ul class="sc-uJMKN fRSLiB"><li>What We Do</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/get-involved><ul class="sc-uJMKN fRSLiB"><li>Get Involved</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/support-us><ul class="sc-uJMKN fRSLiB"><li>Support us</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/blog><ul class="sc-uJMKN fRSLiB"><li>Event blog</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/about-us><ul class="sc-uJMKN fRSLiB"><li>Our team</li></ul></a><a class="sc-jqCOkK glTukf" href=https://nuevofoundation.org/contact><ul class="sc-uJMKN fRSLiB"><li>Contact us</li></ul></a></div></div><div><div class="sc-gGBfsJ iKkPGj"><div class=container-fluid><div id=toprow class=row><div class=col-xs-12><div class="sc-EHOje fJMnSm"><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation><i aria-label="Nuevo Foundation Instagram" class="fab fa-instagram"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation><i aria-label="Nuevo Foundation Twitter" class="fab fa-twitter"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation><i aria-label="Nuevo Foundation Facebook" class="fab fa-facebook-f"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-linkedin"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1n"><i aria-label="Nuevo Foundation YouTube" class="fab fa-youtube"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation><i aria-label="Nuevo Foundation Github" class="fab fa-github"></i></a></div><div class="sc-bZQynM dXgQaH"><a class="sc-gzVnrw cZJBlR" rel="noopener noreferrer" href=https://nuevofoundation.org/support-us>Donate</a></div></div></div></div><div id=secondrow class=row><div class="col-sm-12 hidden-xs"><div class="sc-htoDjs kjtfZK"><a class="sc-fjdhpX izNzAG active" aria-current=page href=https://nuevofoundation.org><img alt="Nuevo Foundation Logo" src=/workshops/images/Logo_long.0f097b90.svg height=60px></a><ul class="sc-iwsKbI bUOvG"><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/what-we-do><li class="sc-gZMcBi Bomeo">What We Do</li></a><a class=izNzAG href=/><li class="sc-gZMcBi Bomeo-selected jgBGVn">Workshops<span></span></li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/get-involved><li class="sc-gZMcBi Bomeo">Get Involved</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/support-us><li class="sc-gZMcBi Bomeo">Support us</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/blog><li class="sc-gZMcBi Bomeo">Event blog</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/about-us><li class="sc-gZMcBi Bomeo">Our team</li></a><a class="sc-fjdhpX izNzAG" href=https://nuevofoundation.org/contact><li class="sc-gZMcBi Bomeo">Contact us</li></a></ul></div></div><div class="hidden-lg hidden-md hidden-sm col-xs-12"><div class=row><div class=col-xs-10><a class="sc-fjdhpX izNzAG active" aria-current=page href=/><img alt="Nuevo Foundation Logo" class="sc-dnqmqq emolVn" src=/workshops/images/Logo_long.0f097b90.svg height=60%></a></div><div class=col-xs-2 onclick=toggleVisibility(); style=padding-top:4%;padding-left:4%;cursor:pointer><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 fa-lg" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></div></div></div></div></div></div></header><article><aside><ul class=menu><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/ class="dd-item parent haschildren"><div><a href=/workshops/machine-learning/>Python: Machine Learning</a>
<i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i></div><ul><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/get-dataset/ class=dd-item><div><a href=/workshops/machine-learning/get-dataset/>Step 1: Get Dataset
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/start-project/ class=dd-item><div><a href=/workshops/machine-learning/start-project/>Step 2: Start the project
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/load-dataset/ class=dd-item><div><a href=/workshops/machine-learning/load-dataset/>Step 3: Load dataset
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/preprocess-data/ class="dd-item active"><div><a href=/workshops/machine-learning/preprocess-data/>Step 4: Pre-process data
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/feature-selection/ class=dd-item><div><a href=/workshops/machine-learning/feature-selection/>Step 5: Feature selection
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/train-model/ class=dd-item><div><a href=/workshops/machine-learning/train-model/>Step 6: Train the model
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/model-testing-data/ class=dd-item><div><a href=/workshops/machine-learning/model-testing-data/>Step 7: Try the model on testing data
</a><i class="fa fa-circle-thin read-icon"></i></div></li><li data-nav-id=https://nuevofoundation.github.io/workshops/machine-learning/closing/ class=dd-item><div><a href=/workshops/machine-learning/closing/>Closing
</a><i class="fa fa-circle-thin read-icon"></i></div></li></ul></li></ul><section></section></aside><section class=page><div align=right><select id=select-language onchange="location=this.value;">
<option id=en value=https://nuevofoundation.github.io/workshops/machine-learning/preprocess-data/ selected>English</option></select></div><div class=nav-select>Navigation:&nbsp;
<select onchange="location.href=this.value;">
<option value=/workshops/machine-learning/>Python: Machine Learning</option>
<option value=/workshops/machine-learning/get-dataset/>- Step 1: Get Dataset</option>
<option value=/workshops/machine-learning/start-project/>- Step 2: Start the project</option>
<option value=/workshops/machine-learning/load-dataset/>- Step 3: Load dataset</option>
<option value=/workshops/machine-learning/preprocess-data/ selected>- Step 4: Pre-process data</option>
<option value=/workshops/machine-learning/feature-selection/>- Step 5: Feature selection</option>
<option value=/workshops/machine-learning/train-model/>- Step 6: Train the model</option>
<option value=/workshops/machine-learning/model-testing-data/>- Step 7: Try the model on testing data</option>
<option value=/workshops/machine-learning/closing/>- Closing</option></select></div><h1>Step 4: Pre-process data</h1><div class="panel panel-primary"><div class=panel-heading>Workshop Resources</div><div class=panel-body><div class=metadata-row><span class=metadata-label>Pre-requisite:</span>
<span class=metadata-value>none</span></div><div class=metadata-row><span class=metadata-label>Difficulty:</span>
<span class=metadata-value>Intermediate</span></div></div></div><p>By now, we have imported our dataset. In real life, each soccer player has a specific position. Different positions require strength in different attributes. So let&rsquo;s narrow down the scope to the striker.</p><p>First, let&rsquo;s list all the positions.
This statement looks a little bit longer, but it does the work. The <code>fifa_data['position']</code> selects position column of the <code>fifa_data</code>, the <code>dropna()</code> eliminates cells that are blank, and <code>unique()</code> remove all duplicated items for us.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># to find out how many positions are there</span>
<span style=color:#00a8c8>print</span><span style=color:#111>(</span><span style=color:#111>fifa_data</span><span style=color:#111>[</span><span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>Position</span><span style=color:#d88200>&#39;</span><span style=color:#111>]</span><span style=color:#f92672>.</span><span style=color:#111>dropna</span><span style=color:#111>(</span><span style=color:#111>)</span><span style=color:#f92672>.</span><span style=color:#111>unique</span><span style=color:#111>(</span><span style=color:#111>)</span><span style=color:#111>)</span>
</code></pre></div><pre><code>['RF' 'ST' 'LW' 'GK' 'RCM' 'LF' 'RS' 'RCB' 'LCM' 'CB' 'LDM' 'CAM' 'CDM'
 'LS' 'LCB' 'RM' 'LAM' 'LM' 'LB' 'RDM' 'RW' 'CM' 'RB' 'RAM' 'CF' 'RWB'
 'LWB']
</code></pre><p>Now we can filter data by position &ldquo;ST&rdquo;. You&rsquo;re encouraged to select other positions to see what&rsquo;s the difference.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># get players by position</span>
<span style=color:#111>fifa_data_by_pos</span> <span style=color:#f92672>=</span> <span style=color:#111>fifa_data</span><span style=color:#111>[</span><span style=color:#111>fifa_data</span><span style=color:#111>[</span><span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>Position</span><span style=color:#d88200>&#39;</span><span style=color:#111>]</span><span style=color:#f92672>==</span><span style=color:#d88200></span><span style=color:#d88200>&#39;</span><span style=color:#d88200>ST</span><span style=color:#d88200>&#39;</span><span style=color:#111>]</span>
</code></pre></div><p>Let&rsquo;s plot a histogram for overall ratings of all strikers.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#111>plt</span><span style=color:#f92672>.</span><span style=color:#111>hist</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#f92672>=</span><span style=color:#111>fifa_data_by_pos</span><span style=color:#111>[</span><span style=color:#111>target</span><span style=color:#111>]</span><span style=color:#111>,</span> <span style=color:#111>bins</span><span style=color:#f92672>=</span><span style=color:#ae81ff>10</span><span style=color:#111>,</span> <span style=color:#111>alpha</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0.75</span><span style=color:#111>,</span> <span style=color:#111>rwidth</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0.85</span><span style=color:#111>)</span>
</code></pre></div><pre><code>(array([ 40., 186., 363., 463., 601., 341., 113.,  34.,   9.,   2.]),
 array([47. , 51.7, 56.4, 61.1, 65.8, 70.5, 75.2, 79.9, 84.6, 89.3, 94. ]),
 &lt;a list of 10 Patch objects&gt;)
</code></pre><p><img src=../images/output_11_1.png alt="Output image"></p><p>Next, we want to split the data into two sets, one is used to train the model, another one is used to verify the trained model is good.</p><p>You may think, we should leave as much as possible data for training because it makes the model better. The model fits better, but only for training datasets. When you apply the model to testing data, the prediction accuracy could go down. This is called &ldquo;overfitting.&rdquo;</p><p>Now, we leave 25% of the data for testing.</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># split data into train_data and test_data randomly</span>
<span style=color:#75715e># you&#39;re weclome to change the ratio of test_size to see what will happen</span>
<span style=color:#111>train_data</span><span style=color:#111>,</span> <span style=color:#111>test_data</span> <span style=color:#f92672>=</span> <span style=color:#111>train_test_split</span><span style=color:#111>(</span><span style=color:#111>fifa_data_by_pos</span><span style=color:#111>,</span><span style=color:#111>test_size</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0.25</span><span style=color:#111>)</span>

<span style=color:#75715e># print the number of players in train_data and test_data</span>
<span style=color:#75715e># len() gives you the number of players in numerical format</span>
<span style=color:#75715e># str() converts numerical value into string</span>
<span style=color:#00a8c8>print</span><span style=color:#111>(</span><span style=color:#d88200></span><span style=color:#d88200>&#34;</span><span style=color:#d88200>The # of training data is </span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>+</span> <span style=color:#111>str</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>train_data</span><span style=color:#111>)</span><span style=color:#111>)</span><span style=color:#111>)</span>
<span style=color:#00a8c8>print</span><span style=color:#111>(</span><span style=color:#d88200></span><span style=color:#d88200>&#34;</span><span style=color:#d88200>The # of testing data is </span><span style=color:#d88200>&#34;</span> <span style=color:#f92672>+</span> <span style=color:#111>str</span><span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#111>(</span><span style=color:#111>test_data</span><span style=color:#111>)</span><span style=color:#111>)</span><span style=color:#111>)</span>
</code></pre></div><pre><code>The # of training data is 1614
The # of testing data is 538</code></pre><div class=chevrons><style>.workshop-complete-image{margin:40px auto 50px;width:340.8px}.workshop-complete-words{font-family:Space Mono,monospace;font-weight:700;font-size:48px;line-height:71px;text-align:center}.horizontal-bar{background-color:#000;width:120px;height:12px;margin:80px auto 0}</style><div id=navigation><div class=next-prev-wrapper-div><a class="nav nav-prev" href=https://nuevofoundation.github.io/workshops/machine-learning/load-dataset/ title="Step 3: Load dataset"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Previous:</div><div class=nextprevbutton-subsection-name>Step 3: Load dataset</div><div class=nextprevbutton-horizontal-bar></div></div><div class=prevbutton-image><i class="fa fa-arrow-left"></i></div></div></a></div><div class=next-prev-wrapper-div><a class="nav nav-next" href=https://nuevofoundation.github.io/workshops/machine-learning/feature-selection/ title="Step 5: Feature selection"><div class=nextprevbutton-border><div class=nextprevbutton-desktop-only><div class=nextprevbutton-next-text>Up Next:</div><div class=nextprevbutton-subsection-name>Step 5: Feature selection</div><div class=nextprevbutton-horizontal-bar></div></div><div class=nextbutton-image><i class="fa fa-arrow-right"></i></div></div></a></div></div></div></section></article><footer><div class=footline><div class=github-link><a href=https://github.com/NuevoFoundation/workshops/tree/master/content/machine-learning/preprocess-data.md target=blank><i class="fa fa-code-fork"></i></a></div></div><div></div></footer><script src=/workshops/js/clipboard.min.js></script><link href=/workshops/css/featherlight.min.css rel=stylesheet><script src=/workshops/js/featherlight.min.js></script><script src=/workshops/theme-flex/script.js></script><div id=footer class=row><div class=col-xs-12><div class=App-footer><div class=App-footer-big>Join the conversation on social media.</div><div class=social-images><a target=_blank rel="noopener noreferrer" href=https://www.instagram.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Instagram" class="fab fa-2x fa-instagram"></i></a><a target=_blank rel="noopener noreferrer" href=https://twitter.com/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation Twitter" class="fab fa-2x fa-twitter"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.facebook.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Facebook" class="fab fa-2x fa-1x fa-facebook-f"></i></a><a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/company/nuevofoundation class=footer-pics><i aria-label="Nuevo Foundation LinkedIn" class="fab fa-2x fa-linkedin"></i></a><a target=_blank rel="noopener noreferrer" href="https://www.youtube.com/nuevofoundation?sub_confirmation=1" class=footer-pics><i aria-label="Nuevo Foundation YouTube" class="fab fa-2x fa-youtube"></i></a><a target=_blank rel="noopener noreferrer" href=https://github.com/NuevoFoundation class=footer-pics><i aria-label="Nuevo Foundation Github" class="fab fa-2x fa-github"></i></a></div><div class=App-footer-small>© Copyright 2022, All Rights Reserved by Nuevo Foundation, a 501(c)(3) nonprofit.</div></div></div></div></body></html>